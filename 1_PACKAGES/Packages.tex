%Common packages
\usepackage[utf8]{inputenc}
\usepackage{import}
\raggedbottom

%Margins (See other options in KSP special course)
    \usepackage[a4paper,width=160mm,top=25mm,bottom=25mm,bindingoffset=6mm]{geometry}
    \setlength{\headheight}{15pt}

% Setup header and footer
    \usepackage{fancyhdr}
    \pagestyle{fancy}
    \usepackage[bottom]{footmisc}

    %Clear the header and the footer
    \fancyhead{}
    \fancyfoot{}
    
    %Set the header and footer
    \fancyfoot[LO,RE]{\footnotesize \thepage}
    \fancyfoot[RO,LE]{\footnotesize \thesistitle}
    
    %Remove horisontal bar in the header
    \renewcommand{\headrulewidth}{0pt}
    

%Figures and tables
    \usepackage{float}
    \usepackage{graphicx}
    \usepackage{subcaption}
    \usepackage{rotating}
    \usepackage[table,xcdraw]{xcolor}
    \usepackage{booktabs}
    \newcommand{\myrowcolour}{\rowcolor[gray]{0.925}}
    \usepackage{lscape}
    \usepackage{threeparttable}
    
%Line spacing (1.3 is used for one-and-a-half spacing)
    \linespread{1.3}
    
%Include mathematics & equations
    \usepackage{amsmath}
    \usepackage{gensymb}
    \newcommand*{\plimsoll}{{\ensuremath{-\kern-4pt{\ominus}\kern-4pt-}}}
    
%%% Biblography %%%
    %\usepackage[maxbibnames=99,sorting=none]{biblatex}
    \usepackage[maxnames=6, minnames=1, style=ieee, citestyle=numeric-comp]{biblatex}
    \addbibresource{references.bib}
    \renewbibmacro{in:}{%
    \ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
  
    
    %%% The MLA Style %%%
    %Fix online sources
    \usepackage{xpatch}
    
    \DeclareBibliographyDriver{online}{%
  \usebibmacro{bibindex}%
  \usebibmacro{begentry}%
  \usebibmacro{author/editor+others/translator+others}%
  \setunit{\adddot\addspace}%
  \printtext[parens]{\usebibmacro{date}}%
  \setunit{\adddot\addspace}%
  \usebibmacro{title}%
  \setunit{\adddot\addspace}%
  \printlist{language}%
  \setunit{\adddot\addspace}%
  \usebibmacro{byauthor}%
  \setunit{\adddot\addspace}%
  \usebibmacro{byeditor+others}%
  \setunit{\adddot\addspace}%
  \printfield{version}%
  \setunit{\adddot\addspace}%
  \printfield{note}%
  \printlist{organization}%
  \setunit{\adddot\addspace}%
  \iftoggle{bbx:eprint}
    {\usebibmacro{eprint}}
    {}%
  \usebibmacro{url+urldate}%
  \setunit{\adddot\addspace}%
  \usebibmacro{addendum+pubstate}%
  \setunit{\bibpagerefpunct}\newblock
  \usebibmacro{pageref}%
  \iftoggle{bbx:related}
    {\usebibmacro{related:init}%
     \usebibmacro{related}}
    {}%
  \usebibmacro{finentry}}
    
    \xpatchbibdriver{online}
  {\printtext[parens]{\usebibmacro{date}}}
  {\iffieldundef{year}
    {}
    {\printtext[parens]{\usebibmacro{date}}}}
  {}
  {\typeout{There was an error patching biblatex-ieee (specifically, ieee.bbx's @online driver)}}
  \DeclareFieldFormat[online,report]{title}{``#1"}
  \DeclareFieldFormat{url}{\bibstring{url}\url{#1}}
  \DefineBibliographyStrings{english}{
  url         =,
}
    %Fix margin in biblatex
    \appto{\bibsetup}{\raggedright}


    
%Lists
    \usepackage{multicol}
    \usepackage{multirow}
    
%Symbols and arrows
    \usepackage{textcomp}
    \usepackage{tikz-cd}

%Layout
    \usepackage[explicit]{titlesec}
    \usetikzlibrary{shadows.blur}
    \usepackage{titletoc}
    \usepackage{calc}
    \usepackage{fix-cm}
    \usepackage{type1cm}
    \usepackage{etoc}
    \usepackage{wallpaper}
    \usepackage{enumitem}
    
    %Colours
    \definecolor{mybluei}{RGB}{28,138,207}
    \definecolor{myblueii}{RGB}{131,197,231}
    
    %Chapter
     %\titleformat{\chapter}[block]{\Huge\fontfamily{qag}\selectfont}{\thechapter}{.5em}{\titlerule\\[.8ex]\bfseries #1}
     
    \titleformat{\chapter}[display]
        {\normalfont\color{mybluei}}
        {\filleft\Huge\fontfamily{qag}\selectfont\bfseries\chaptertitlename\hspace*{4mm}%
        \begin{tikzpicture}[baseline={([yshift=-1.5ex]current bounding box.center)}]
            \node[fill=mybluei,rectangle,text=white,minimum width=2.2cm, minimum height=2.2cm] {\fontfamily{qag}\selectfont\fontsize{50}{10}\selectfont\thechapter};
        \end{tikzpicture}}
        {-.2ex}
        {\titlerule[1.5pt]\vspace*{4ex}\fontfamily{qag}\selectfont\fontsize{40}{10}\selectfont\color{black} #1}
        []  
   
   \titleformat{name=\chapter,numberless}[display]
        {\normalfont\color{mybluei}}
        {}
        {1ex}
        {\vspace*{4ex}\fontfamily{qag}\selectfont\fontsize{40}{10}\selectfont\color{black} #1}
        []
   
    %Section
    \titleformat{\section}[hang]{\Large\bfseries\fontfamily{qag}\selectfont}%
    {\rlap{\color{mybluei}\rule[-6pt]{\textwidth}{1.2pt}}\colorbox{mybluei}{%
          \raisebox{0pt}[15pt][3pt]{ \makebox[60pt]{% height, width
            \fontfamily{qag}\selectfont\color{white}\Large{\thesection}}
            }}}%
    {15pt}%
    { \color{black}#1
    %
    }
    \titlespacing*{\section}{0pt}{3mm}{3mm}
    
    %subsection
    \titleformat{\subsection}[hang]{\large\bfseries\fontfamily{qag}\selectfont}%
    {\rlap{\color{mybluei}\rule[-6pt]{\textwidth}{1.2pt}}\colorbox{mybluei}{%
          \raisebox{0pt}[13pt][3pt]{ \makebox[60pt]{% height, width
            \fontfamily{qag}\selectfont\color{white}\large{\thesubsection}}
            }}}%
    {15pt}%
    { \color{black}#1
    %
    }
    \titlespacing*{\subsection}{0pt}{5mm}{3mm}
    
    %subsubsetion
    \titleformat{\subsubsection}[hang]{\normalsize\bfseries\fontfamily{qag}\selectfont}%
    {\rlap{\color{mybluei}\rule[-6pt]{\textwidth}{1.2pt}}\colorbox{mybluei}{%
          \raisebox{0pt}[13pt][3pt]{ \makebox[60pt]{% height, width
            \fontfamily{qag}\selectfont\color{white}\large{\thesubsubsection}}
            }}}%
    {15pt}%
    { \color{black}#1
    %
    }
    \titlespacing*{\subsubsection}{0pt}{3mm}{1mm}
    

%Fontfamilies
%https://www.overleaf.com/learn/latex/font_typefaces
%Before it was ssfamily
    \usepackage{hyperref}
    % \hypersetup{
    % colorlinks=true,
    % linkcolor=black,
    % filecolor=magenta,      
    % urlcolor=cyan,
    % pdftitle={Overleaf Example},
    % pdfpagemode=FullScreen,
    % }
    
%Scripts
    \usepackage{listings}
    \definecolor{codegreen}{rgb}{0,0.6,0}
    \definecolor{codegray}{rgb}{0.5,0.5,0.5}
    \definecolor{codepurple}{rgb}{0.58,0,0.82}
    \definecolor{backcolour}{rgb}{0.95,0.95,0.92}

    \definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

    \lstset{style=mystyle}

